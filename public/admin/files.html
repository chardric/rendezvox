<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin — File Manager</title>
<link rel="icon" type="image/svg+xml" href="/assets/icon.svg">
<link rel="stylesheet" href="/admin/css/admin.css?v=glow1">
<style>
/* ── File Manager Layout ──────────────────────────────── */
.fm-wrap {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 130px);
  min-height: 400px;
}
.fm-layout {
  display: flex;
  flex: 1;
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  background: var(--bg-card);
}

/* ── Tree panel ──────────────────────────────────────── */
.fm-tree {
  width: 220px;
  min-width: 180px;
  flex-shrink: 0;
  border-right: 1px solid var(--border);
  overflow-y: auto;
  background: var(--bg-card);
}
.fm-tree::-webkit-scrollbar { width: 4px; }
.fm-tree::-webkit-scrollbar-track { background: transparent; }
.fm-tree::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

.fm-tn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 8px;
  cursor: pointer;
  font-size: .82rem;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
  border-radius: 4px;
  margin: 1px 4px;
}
.fm-tn:hover { background: var(--hover-overlay); }
.fm-tn.active { background: rgba(0,200,160,.12); color: var(--accent); }
.fn-arr {
  flex-shrink: 0;
  transition: transform .15s;
  opacity: .5;
}
.fn-arr.open { transform: rotate(90deg); }
.fn-spacer { width: 10px; flex-shrink: 0; display: inline-block; }
.fn-label { flex: 1; overflow: hidden; text-overflow: ellipsis; }
.fm-tc { display: none; }
.fm-tc.open { display: block; }

/* ── Content pane ────────────────────────────────────── */
.fm-pane {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-width: 0;
}

/* ── Toolbar ─────────────────────────────────────────── */
.fm-toolbar {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 8px 12px;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
  flex-shrink: 0;
}
.fm-divider {
  width: 1px;
  height: 18px;
  background: var(--border);
  margin: 0 3px;
  flex-shrink: 0;
}
.fm-status {
  margin-left: auto;
  font-size: .78rem;
  color: var(--text-dim);
  white-space: nowrap;
  flex-shrink: 0;
}

/* ── Breadcrumb ──────────────────────────────────────── */
.fm-breadcrumb {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 8px 14px;
  border-bottom: 1px solid var(--border);
  font-size: .82rem;
  flex-wrap: wrap;
  flex-shrink: 0;
}
.bc-sep { color: var(--text-dim); }
.bc-link { color: var(--accent); cursor: pointer; text-decoration: none; }
.bc-link:hover { text-decoration: underline; }
.bc-current { color: var(--text); font-weight: 500; }

/* ── File list ───────────────────────────────────────── */
.fm-content {
  flex: 1;
  overflow-y: auto;
  padding: 6px;
}
.fm-items { display: flex; flex-direction: column; gap: 1px; }
.fm-empty {
  padding: 60px 20px;
  text-align: center;
  color: var(--text-dim);
  font-size: .9rem;
}

.fm-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 5px;
  cursor: pointer;
  user-select: none;
  border: 1px solid transparent;
}
.fm-item:hover { background: var(--hover-overlay); }
.fm-item.selected { background: rgba(0,200,160,.1); border-color: rgba(0,200,160,.25); }
.fm-item.cut-mode { opacity: .45; }

.item-icon { flex-shrink: 0; color: var(--text-dim); display: flex; align-items: center; }
.item-icon.folder-icon { color: #f59e0b; }
.item-name { flex: 1; font-size: .875rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }
.item-meta { font-size: .75rem; color: var(--text-dim); flex-shrink: 0; min-width: 60px; text-align: right; }
.item-actions { flex-shrink: 0; display: flex; gap: 3px; opacity: 0; }
.fm-item:hover .item-actions,
.fm-item.selected .item-actions { opacity: 1; }

/* ── Rename input ────────────────────────────────────── */
.rename-input {
  background: var(--bg-input);
  border: 1px solid var(--accent);
  color: var(--text);
  border-radius: 4px;
  padding: 1px 6px;
  font-size: .875rem;
  min-width: 120px;
  max-width: 300px;
  width: 100%;
  outline: none;
}

/* ── Context menu ────────────────────────────────────── */
.ctx-menu {
  position: fixed;
  z-index: 9999;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 6px;
  box-shadow: 0 6px 20px rgba(0,0,0,.45);
  min-width: 160px;
  padding: 4px 0;
  animation: ctxFadeIn .08s ease;
}
@keyframes ctxFadeIn { from { opacity:0; transform:scale(.97); } to { opacity:1; transform:scale(1); } }
.ctx-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 14px;
  font-size: .83rem;
  cursor: pointer;
  color: var(--text);
}
.ctx-item:hover { background: var(--hover-overlay); }
.ctx-item.ctx-danger { color: var(--danger); }
.ctx-icon { flex-shrink: 0; opacity: .7; display: flex; }
.ctx-sep { height: 1px; background: var(--border); margin: 3px 0; }
/* ── Drag-and-drop ───────────────────────────────────── */
.fm-item.dragging { opacity: .3; }
.fm-item.drag-over,
.fm-tn.drag-over {
  background: rgba(99,102,241,.15) !important;
  outline: 2px solid var(--primary, #6366f1);
  outline-offset: -2px;
  border-radius: 4px;
}
/* ── Lasso / rubber-band selection ───────────────────── */
.fm-lasso {
  position: fixed;
  border: 1px solid var(--primary, #6366f1);
  background: rgba(99,102,241,.1);
  pointer-events: none;
  z-index: 9999;
  border-radius: 2px;
}
</style>
</head>
<body>
<div class="app">
  <button id="hamburger" class="hamburger">
    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
  </button>
  <div id="overlay" class="overlay"></div>
  <aside id="sidebar" class="sidebar"></aside>

  <main class="main">
    <div class="flex items-center justify-between" style="margin-bottom:16px">
      <h1 class="page-title" style="margin-bottom:0">File Manager</h1>
      <span style="font-size:.8rem;color:var(--text-dim)">Music folder</span>
    </div>

    <div class="fm-wrap">
      <!-- Toolbar -->
      <div class="fm-toolbar">
        <button class="btn btn-ghost btn-sm" id="btnNewFolder">
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/><line x1="12" y1="11" x2="12" y2="17"/><line x1="9" y1="14" x2="15" y2="14"/></svg>New Folder
        </button>
        <div class="fm-divider"></div>
        <button class="btn btn-ghost btn-sm" id="btnCut" disabled>
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><circle cx="6" cy="20" r="2"/><circle cx="6" cy="4" r="2"/><line x1="6" y1="2" x2="6" y2="22"/><line x1="21" y1="2" x2="6" y2="22"/><line x1="21" y1="22" x2="6" y2="2"/></svg>Cut
        </button>
        <button class="btn btn-ghost btn-sm" id="btnCopy" disabled>
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>Copy
        </button>
        <button class="btn btn-ghost btn-sm" id="btnPaste" disabled>
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/></svg>Paste
        </button>
        <div class="fm-divider"></div>
        <button class="btn btn-ghost btn-sm" id="btnRename" disabled>
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4z"/></svg>Rename
        </button>
        <button class="btn btn-sm" id="btnDelete" disabled style="color:var(--danger);border-color:var(--danger);background:transparent;">
          <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:3px"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4h6v2"/></svg>Delete
        </button>
        <span id="fm-status" class="fm-status"></span>
      </div>

      <!-- Two-panel layout -->
      <div class="fm-layout">
        <!-- Left: folder tree -->
        <div id="fm-tree" class="fm-tree">
          <div style="padding:20px;color:var(--text-dim);font-size:.82rem">Loading…</div>
        </div>

        <!-- Right: content pane -->
        <div class="fm-pane">
          <div id="fm-breadcrumb" class="fm-breadcrumb"></div>
          <div id="fm-content" class="fm-content">
            <div class="fm-empty">Loading…</div>
          </div>
        </div>
      </div>
    </div><!-- /.fm-wrap -->

    <!-- Keyboard hint -->
    <div style="margin-top:8px;font-size:.74rem;color:var(--text-dim)">
      Ctrl+C copy &nbsp;·&nbsp; Ctrl+X cut &nbsp;·&nbsp; Ctrl+V paste &nbsp;·&nbsp; Del delete &nbsp;·&nbsp; F2 rename &nbsp;·&nbsp; Double-click to open folder
    </div>
  </main>
</div><!-- /.app -->

<div id="toasts" class="toasts"></div>

<!-- New Folder Modal -->
<div id="newFolderModal" class="modal-backdrop" style="display:none">
  <div class="modal" style="max-width:340px">
    <h3>New Folder</h3>
    <button type="button" class="modal-close" id="btnCancelFolderX">&times;</button>
    <div style="margin:16px 0">
      <label style="font-size:.82rem;color:var(--text-dim);display:block;margin-bottom:6px">Folder name</label>
      <input type="text" id="newFolderName" placeholder="e.g. Rock / Jazz / Oldies" style="width:100%">
    </div>
    <div class="modal-actions">
      <button type="button" class="btn btn-ghost" id="btnCancelFolder">Cancel</button>
      <button type="button" class="btn btn-primary" id="btnCreateFolder">Create</button>
    </div>
  </div>
</div>

<script src="/admin/js/api.js"></script>
<script src="/admin/js/auth.js"></script>
<script src="/admin/js/theme.js"></script>
<script src="/admin/js/nav.js"></script>
<script src="/admin/js/confirm.js"></script>
<script src="/admin/js/filemanager.js?v=8"></script>
</body>
</html>
